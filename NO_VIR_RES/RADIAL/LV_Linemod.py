import math
import PUdefs as pu
import numpy as np
from numba import njit
from PUdefs import Wrated
from param_arr import *

@njit
def LV_curr(x, Vin, wsys, LVparams):

    #------- Currents-------



    Iq1 = x[0]
    Id1 = x[1]

    Iq2 = x[2]
    Id2 = x[3]

    Iq3 = x[4]
    Id3 = x[5]

    Iq4 = x[6]
    Id4 = x[7]

    Iq5 = x[8]
    Id5 = x[9]


    # ----- Voltages-------

    Vqg = Vin[0]
    Vdg = Vin[1]

    Vqc1 = Vin[2]
    Vdc1 = Vin[3]

    Vqc2 = Vin[4]
    Vdc2 = Vin[5]

    Vqc3 = Vin[6]
    Vdc3 = Vin[7]

    Vqc4 = Vin[8]
    Vdc4 = Vin[9]

    Vqc5 = Vin[10]
    Vdc5 = Vin[11]

    F = np.empty((10))

    Iq1_  = 0
    Iq2_  = 0
    Iq3_  = 0
    Iq4_  = 0
    Iq5_  = 0

    Id1_  = 0
    Id2_  = 0
    Id3_  = 0
    Id4_  = 0
    Id5_  = 0


    # i = 0
    # j = 0
    # # ---Q axis components---------------
    # # while j < 12:
    # #     Iqg1_ = LVparams[i] * x[j] + LVparams[i + 6] * Vin[j] + Iqg1_
    # #     Idg1_ = LVparams[i] * x[j+1] + LVparams[i + 6] * Vin[j+1] + Idg1_
    # #
    # #     j = j + 2
    # #     i = i + 1
    # # i = i + 6
    # # j = 0
    # while j < 10:
    #     Iq1_ = LVparams[i] * x[j] + LVparams[i + 5] * Vin[j] + Iq1_
    #     Id1_ = LVparams[i] * x[j+1] + LVparams[i + 5] * Vin[j+1] + Id1_
    #
    #     j = j + 2
    #     i = i + 1
    #
    # i = i + 5
    # j = 0
    # while j < 10:
    #     Iq2_ = LVparams[i] * x[j] + LVparams[i + 5] * Vin[j] + Iq2_
    #     Id2_ = LVparams[i] * x[j+1] + LVparams[i + 5] * Vin[j+1] + Id2_
    #
    #     j = j + 2
    #     i = i + 1
    #
    # i = i + 5
    # j = 0
    # while j < 10:
    #     Iq3_ = LVparams[i] * x[j] + LVparams[i + 5] * Vin[j] + Iq3_
    #     Id3_ = LVparams[i] * x[j+1] + LVparams[i + 5] * Vin[j+1] + Id3_
    #
    #     j = j + 2
    #     i = i + 1
    #
    # i = i + 5
    # j = 0
    # while j < 10:
    #     Iq4_ = LVparams[i] * x[j] + LVparams[i + 5] * Vin[j] + Iq4_
    #     Id4_ = LVparams[i] * x[j+1] + LVparams[i + 5] * Vin[j+1] + Id4_
    #
    #     j = j + 2
    #     i = i + 1
    #
    # i = i + 5
    # j = 0
    # while j < 10:
    #     Iq5_ = LVparams[i] * x[j] + LVparams[i + 5] * Vin[j] + Iq5_
    #     Id5_ = LVparams[i] * x[j+1] + LVparams[i + 5] * Vin[j+1] + Id5_
    #
    #     j = j + 2
    #     i = i + 1


    Iq1_ = -239.823610544424 * Iq1 - 152.816664590368 * Iq2 - 24.2138712730917 * Iq3 - 133.011360601484 * Iq4 - 128.56438452624 * Iq5 + 46.410306070157 * Vqc1 - 16.3046432474268 * Vqc2 - 2.98165464137649 * Vqc3 - 11.9097509291634 * Vqc4 - 10.9229455257443 * Vqc5 - 4.29131172644595 * Vqg
    Iq2_ = -137.803950280693 * Iq1 - 215.717803454263 * Iq2 - 3.15808622839936 * Iq3 - 123.882063681069 * Iq4 - 118.947605700887 * Iq5 - 16.3046432474268 * Vqc1 + 48.4281071416601 * Vqc2 - 3.30850656498789 * Vqc3 - 13.2153095766709 * Vqc4 - 12.1203295913059 * Vqc5 - 3.47931816126859 * Vqg
    Iq3_ = -25.2004157171164 * Iq1 - 26.6733532176724 * Iq2 - 628.316894753794 * Iq3 - 26.875855759814 * Iq4 - 25.6237153724309 * Iq5 - 2.98165464137648 * Vqc1 - 3.3085065649879 * Vqc2 + 13.3554590804678 * Vqc3 - 3.3534428541449 * Vqc4 - 3.07558687309124 * Vqc5 - 0.636268146867252 * Vqg
    Iq4_ = -100.659100600485 * Iq1 - 106.542517989746 * Iq2 + 15.012273523752 * Iq3 - 200.294471152128 * Iq4 - 123.520987325956 * Iq5 - 11.9097509291634 * Vqc1 - 13.2153095766709 * Vqc2 - 3.3534428541449 * Vqc3 + 48.0028901639744 * Vqc4 - 16.9829136742127 * Vqc5 - 2.54147312978235 * Vqg
    Iq5_ = -92.3187965112806 * Iq1 - 97.7147319956032 * Iq2 + 13.768402621756 * Iq3 - 119.627659311996 * Iq4 - 207.983676990056 * Iq5 - 10.9229455257443 * Vqc1 - 12.120329591306 * Vqc2 - 3.07558687309124 * Vqc3 - 16.9829136742127 * Vqc4 + 45.4326701319941 * Vqc5 - 2.33089446763979 * Vqg

    Id1_ = -239.823610544424 * Id1 - 152.816664590368 * Id2 - 24.2138712730917 * Id3 - 133.011360601484 * Id4 - 128.56438452624 * Id5 + 46.410306070157 * Vdc1 - 16.3046432474268 * Vdc2 - 2.98165464137649 * Vdc3 - 11.9097509291634 * Vdc4 - 10.9229455257443 * Vdc5 - 4.29131172644595 * Vdg
    Id2_ = -137.803950280693 * Id1 - 215.717803454263 * Id2 - 3.15808622839936 * Id3 - 123.882063681069 * Id4 - 118.947605700887 * Id5 - 16.3046432474268 * Vdc1 + 48.4281071416601 * Vdc2 - 3.30850656498789 * Vdc3 - 13.2153095766709 * Vdc4 - 12.1203295913059 * Vdc5 - 3.47931816126859 * Vdg
    Id3_ = -25.2004157171164 * Id1 - 26.6733532176724 * Id2 - 628.316894753794 * Id3 - 26.875855759814 * Id4 - 25.6237153724309 * Id5 - 2.98165464137648 * Vdc1 - 3.3085065649879 * Vdc2 + 13.3554590804678 * Vdc3 - 3.3534428541449 * Vdc4 - 3.07558687309124 * Vdc5 - 0.636268146867252 * Vdg
    Id4_ = -100.659100600485 * Id1 - 106.542517989746 * Id2 + 15.012273523752 * Id3 - 200.294471152128 * Id4 - 123.520987325956 * Id5 - 11.9097509291634 * Vdc1 - 13.2153095766709 * Vdc2 - 3.3534428541449 * Vdc3 + 48.0028901639744 * Vdc4 - 16.9829136742127 * Vdc5 - 2.54147312978235 * Vdg
    Id5_ = -92.3187965112806 * Id1 - 97.7147319956032 * Id2 + 13.768402621756 * Id3 - 119.627659311996 * Id4 - 207.983676990056 * Id5 - 10.9229455257443 * Vdc1 - 12.120329591306 * Vdc2 - 3.07558687309124 * Vdc3 - 16.9829136742127 * Vdc4 + 45.4326701319941 * Vdc5 - 2.33089446763979 * Vdg


    F[0] = Iq1_ + Id1 * wsys * Wrated
    F[1] = Id1_ - Iq1 * wsys * Wrated

    F[2] = Iq2_ + Id2 * wsys * Wrated
    F[3] = Id2_ - Iq2 * wsys * Wrated

    F[4] = Iq3_ + Id3 * wsys * Wrated
    F[5] = Id3_ - Iq3 * wsys * Wrated

    F[6] = Iq4_ + Id4 * wsys * Wrated
    F[7] = Id4_ - Iq4 * wsys * Wrated

    F[8] = Iq5_ + Id5 * wsys * Wrated
    F[9] = Id5_ - Iq5 * wsys * Wrated


    return F

